<scroll-view style="width: 393px; height: 844px; background: #F8F9FD;" scroll-y="true" enhanced="true" show-scrollbar="false">
  <view style="padding: 21px 14px;">
  
  <!-- 页面标题 -->
  <view style="width: 365px; height: 50px; display: flex; align-items: center; justify-content: space-between; margin-bottom: 21px;">
    <text style="color: #1A1D2E; font-size: 21px; font-weight: 600;">自定义字段</text>
    <view style="width: 42px; height: 42px; background: #FF6B6B; border-radius: 8.50px; display: flex; align-items: center; justify-content: center;" bindtap="showAddField">
      <text style="color: white; font-size: 24px; font-weight: 300;">+</text>
    </view>
  </view>

  <!-- 字段列表 -->
  <view wx:if="{{customFields.length > 0}}" style="width: 365px; padding-bottom: 120px; box-sizing: border-box;">
    <view wx:for="{{customFields}}" wx:key="_id"
          data-index="{{index}}"
          bindlongpress="handleDragStart"
          catchtouchmove="handleDragMove"
          catchtouchend="handleDragEnd"
          catchtouchcancel="handleDragCancel"
          style="width: 365px; height: 87.50px; background: white; border-radius: 10.50px; outline: 1px #E5E7EB solid; outline-offset: -1px; margin-bottom: 14px; padding: 14px; display: flex; align-items: center; justify-content: space-between; {{draggingIndex === index ? 'opacity:0.85; transform: scale(0.98); box-shadow: 0px 8px 16px rgba(15, 23, 42, 0.12); position: relative; z-index: 10;' : ''}}">
      
      <!-- 左侧：字段预览 -->
      <view style="display: flex; align-items: center; flex: 1;">
        <view style="width: 49px; height: 21px; background: {{item.colorObj.background || '#F3F4F6'}}; border-radius: 16777200px; margin-right: 14px; display: flex; align-items: center; justify-content: center;">
          <t-icon name="{{item.icon || 'user-1'}}" size="10.5px" style="margin-right: 3.50px"></t-icon>
          <text style="color: {{item.colorObj.text || '#1F2937'}}; font-size: 10.50px; font-weight: 400; letter-spacing: 0.09px;">{{item.name}}</text>
        </view>
        <text style="color: #9CA3AF; font-size: 14px; font-weight: 400;">待点添加</text>
      </view>

      <!-- 右侧：操作按钮 -->
      <view style="display: flex; align-items: center; gap: 8px;">
        <!-- 上移按钮 -->
        <view wx:if="{{index > 0}}" style="width: 32px; height: 32px; background: #F3F4F6; border-radius: 6px; display: flex; align-items: center; justify-content: center;" catchtap="moveFieldUp" data-id="{{item._id}}">
          <t-icon name="arrow-up-3" size="16px"></t-icon>
        </view>
        
        <!-- 下移按钮 -->
        <view wx:if="{{index < customFields.length - 1}}" style="width: 32px; height: 32px; background: #F3F4F6; border-radius: 6px; display: flex; align-items: center; justify-content: center;" catchtap="moveFieldDown" data-id="{{item._id}}">
          <t-icon name="arrow-down-3" size="16px"></t-icon>
        </view>
        
        <!-- 编辑按钮 -->
        <view style="width: 32px; height: 32px; background: #DBEAFE; border-radius: 6px; display: flex; align-items: center; justify-content: center;" catchtap="editField" data-id="{{item._id}}">
          <text style="color: #1E40AF; font-size: 12px;">编辑</text>
        </view>
        
        <!-- 删除按钮 -->
        <view style="width: 32px; height: 32px; background: #FEE2E2; border-radius: 6px; display: flex; align-items: center; justify-content: center;" catchtap="deleteField" data-id="{{item._id}}" data-name="{{item.name}}">
          <text style="color: #DC2626; font-size: 12px;">删除</text>
        </view>
      </view>
    </view>
  </view>

  <!-- 空状态 -->
  <view wx:else style="width: 365px; height: 400px; display: flex; flex-direction: column; align-items: center; justify-content: center; padding-bottom: 120px; box-sizing: border-box;">
    <view style="width: 120px; height: 120px; background: #F3F4F6; border-radius: 60px; display: flex; align-items: center; justify-content: center; margin-bottom: 21px;">
      <text style="color: #9CA3AF; font-size: 48px; font-weight: 300;">+</text>
    </view>
    <text style="color: #6B7280; font-size: 16px; font-weight: 400; margin-bottom: 14px;">暂无自定义字段</text>
    <text style="color: #9CA3AF; font-size: 14px; font-weight: 400;">点击右上角 + 添加字段</text>
  </view>

  </view>

  <!-- 添加字段弹窗 -->
  <view wx:if="{{showAddModal}}" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0, 0, 0, 0.5); display: flex; align-items: center; justify-content: center; z-index: 1000;">
    <view style="width: 320px; background: white; border-radius: 12px; padding: 24px;">
      <view style="text-align: center; margin-bottom: 24px;">
        <text style="color: #1A1D2E; font-size: 18px; font-weight: 600;">添加自定义字段</text>
      </view>
      
      <view style="display: flex; gap: 12px;">
        <view style="flex: 1; height: 44px; background: #F3F4F6; border-radius: 8px; display: flex; align-items: center; justify-content: center;" bindtap="hideAddModal">
          <text style="color: #6B7280; font-size: 16px;">取消</text>
        </view>
        <view style="flex: 1; height: 44px; background: #FF6B6B; border-radius: 8px; display: flex; align-items: center; justify-content: center;" bindtap="goToAddField">
          <text style="color: white; font-size: 16px;">添加字段</text>
        </view>
      </view>
    </view>
  </view>

</scroll-view>